diff -up dhcp-4.1.0p1/omapip/hash.c.CVE-2010-2156 dhcp-4.1.0p1/omapip/hash.c
--- dhcp-4.1.0p1/omapip/hash.c.CVE-2010-2156	2007-11-07 20:42:18.000000000 +0100
+++ dhcp-4.1.0p1/omapip/hash.c	2010-06-18 14:02:22.000000000 +0200
@@ -49,8 +49,14 @@ find_length(const void *key,
 	if (do_hash == do_ip4_hash)
 		return 4;
 
-	log_fatal("Impossible condition at %s:%d.", MDL);
-	return 0; /* Silence compiler warnings. */
+	log_debug("Unexpected hash function at %s:%d.", MDL);
+	/*
+	 * If we get a hash function we don't specifically expect
+	 * return a length of 0, this covers the case where a client
+	 * id has a length of 0.
+	 */
+	return 0;
+	
 }
 
 int new_hash_table (tp, count, file, line)
