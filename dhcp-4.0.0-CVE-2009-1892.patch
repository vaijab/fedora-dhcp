diff -up dhcp-4.0.0/server/dhcp.c.CVE-2009-1892 dhcp-4.0.0/server/dhcp.c
--- dhcp-4.0.0/server/dhcp.c.CVE-2009-1892	2007-11-02 12:09:02.000000000 -1000
+++ dhcp-4.0.0/server/dhcp.c	2009-08-05 12:11:26.000000000 -1000
@@ -1725,6 +1725,8 @@ void ack_lease (packet, lease, offer, wh
 				host_reference (&host, h, MDL);
 		}
 		if (!host) {
+			if (hp)
+				host_dereference (&hp, MDL);
 			find_hosts_by_haddr (&hp,
 					     packet -> raw -> htype,
 					     packet -> raw -> chaddr,
