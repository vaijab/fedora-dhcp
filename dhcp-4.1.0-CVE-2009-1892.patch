diff -up dhcp-4.1.0/server/dhcp.c.CVE-2009-1892 dhcp-4.1.0/server/dhcp.c
--- dhcp-4.1.0/server/dhcp.c.CVE-2009-1892	2008-11-03 08:13:58.000000000 -1000
+++ dhcp-4.1.0/server/dhcp.c	2009-08-05 11:34:07.000000000 -1000
@@ -1755,6 +1755,8 @@ void ack_lease (packet, lease, offer, wh
 				host_reference (&host, h, MDL);
 		}
 		if (!host) {
+			if (hp)
+				host_dereference (&hp, MDL);
 			find_hosts_by_haddr (&hp,
 					     packet -> raw -> htype,
 					     packet -> raw -> chaddr,
